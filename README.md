# scan_util

Задание с отбора на стажировку в Kaspersky.
Утилита на языке C++, работающая из командной строки, выполняющая сканирование файлов в директории, с целью нахождения в ней “подозрительных” (suspicious) файлов.

## Installation
```
cmake CMakeLists.txt
make all
```

## Usage
```
./scan_util [directory-name]
```

## Testing
```
./generate_test_directory [directory-name] [number-of-files]
```
В результате работы этого скрипта будет создана ```directory-name```, содержащая ```number-of-files``` файлов формата ```js, cmd, bat, exe или dll``` размером около нескольких мегабайт.
Также в консоль будет выведено общее количество созданных файлов того или иного типа (js, cmd, exe) и количество зараженных файлов среди каждого из них. Ограничивать доступ на чтение, если захочется, придется вручную.

## Review
### Устройство
Классы, которые реализует и использует программа:
- ```FileType```, объекты которого содержат в себе
  - **тип файла** (enum);
  - **регулярку**, по которой можно определить расширение;
  - **список** возможных подозрительных строк;
- ```Dispatcher```, хранящий в себе вектор из ```FileType```; управляет сканером ```Scanner```: обрабатывает и записывает результат его работы в ```AnalysisResult```;
- ```Scanner```, способный сканировать отдельно взятый файл;
- ```Parser```, способный получить список имен всех файлов в директории;
- ```AnalysisResult```, который хранит в себе все результаты анализа, включая время выполнения. 

### Принцип работы
1. Получив на вход имя директории, утилита с помощью объекта класса ```Parser``` получает список имен файлов в ней.
2. Проинициализировав ```Dispatcher```, программа в цикле передает ему ```AnalysisResult``` и имена файлов. Этот цикл выполняется в параллельном режиме.
3. ```Dispatcher``` передает имя файла и массив подозрительных строк для поиска в ```Scanner```, который читает каждый файл по строкам и ищет с помощью регулярного выражения совпадение с подозрительной строкой.
4. ```Dispatcher``` обрабатывает результат работы ```Scanner```, пишет его в ```AnalysisResult```.
5. После сканирования всех файлов результат анализа выводится в консоль.